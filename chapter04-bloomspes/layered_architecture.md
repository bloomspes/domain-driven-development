# LAYERED ARCHITECTURE

사용자 인터페이스, 어플리케이션 응용 계층, 도메인, 인프라 영역으로 관심사를 분리하자.

## 왜 관심사를 분리하지?

두 가지 영역 이상으로 관심사가 깊게 침투하는 경우, 업무 규칙을 변경하는 작업이 생겼을 때 모든 영역을 아우르면서 변경해야 하는 일이 발생할 수 있다.  
즉, 내가 필요한 것은 사용자 인터페이스를 개선해야 하는 일인데 결과적으로 업무 로직 자체를 변경하게 될 수도 있다.  
이러한 설계는 결국 모델과 코드가 긴밀하게 연결되는 설계와 멀어질 수 밖에 없다.  
책에서는 이것을 응집력 있는 설계라고 표현했다.

## (예제) 온라인 뱅킹 기능을 여러 계층으로 나누기

> 거듭 말하지만 경험과 관례를 바탕으로 널리 받아들여지는 계층화가 어느정도 정해졌다.

1. 복잡해 보이는 프로젝트를 UI, 응용 계층, 도메인, 인프라 영역으로 나눈다.
2. 도메인 모델과 관련된 코드는 모두 도메인 모델 영역으로 몰아넣고 외부 계층과 격리 시킨다.
3. 상위 계층과의 결합은 느슨하게 유지시킨다.

예제에서 우리가 눈여겨 봐야 할 점은, `하위 계층 -> 상위 계층`으로 의존성이 `단방향`으로 주입되었다는 점 이다. 전체 프로세스에서 역행하는 업무 로직은 승인으로 인한 업무만이 전부이다. 컨트롤러에서 서비스로 요청을 전달하면, 서비스에 들어온 객체는 도메인으로 향하고 온라인 뱅킹의 주요 업무가 도메인 영역을 벗어 나지 않는다. 이렇게 주요 업무 프로세스가 끝난 뒤 결과물을 인프라 영역에 전달해서 업데이트 하는 방향으로 외부 영역과 소통한다. 

## 계층 간 관계 설정에서 우리가 알아야 할 점
> 분리의 주된 이점은 어플리케이션 계층이 단순해져서 어플리케이션 본연의 책임에만 집중하게 되는 것이며, 이로써 메시지를 "언제" 보내는지는 알아도 어떻게 보내는 지는 알 필요가 없어진다.

이 단락의 핵심. 전체의 내용이 이 한 문장을 말하기 위해 쓰여졌다고 하면 조금 과한 표현이 되겠지만 좋은 설명이다.   
왜, 보내는 시점이 중요할까. 앞서 예시를 들었던 온라인 뱅킹 구현을 생각해본다. 
응용 계층에서 쓰였던 서비스의 기능을 본다면 서비스를 호출하는 레이어는 어디일지 쉽게 예상할 수 있다. 

## 아키텍쳐 프레임워크 : 최소한의 기능, 다양하게 선택해서 사용해도 좋다.

하나의 프레임워크에서 문제를 모두 해결하던 방식은 이제 시간대비 효율이 좋지 못하다. 좋은 프레임워크는 끊임 없이 나오고있고, 어려운 문제도 다른 프레임워크에서는 쉽게 해결될 수 있는 상황이 왔다. 
책에서는, 해결할 수 있는 방안 중에서 최소한의 시간을 들여서 최소한으로 프레임워크의 기능을 사용해서 문제를 해결하기를 권고한다.
